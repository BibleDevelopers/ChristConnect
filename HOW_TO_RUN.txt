# How to Run ChristConnect (with Docker for Development)

This guide explains how to set up and run the ChristConnect project using Docker for a consistent local development environment.

## 1. Initial Setup

### Step 1: Create Environment File
The application requires an environment file (`.env`) for its configuration. You can create this by copying the provided template. This file is ignored by git and should not be committed.

```bash
copy .env.example .env
```
*(On Linux or macOS, use `cp .env.example .env`)*


### Step 2: Build and Run Containers
This command will build the necessary Docker images (for PHP, Nginx, etc.) and start all the services in the background.

```bash
docker-compose up -d --build
```

The services defined in `docker-compose.yml` (app, web, db) will now be running.

## 2. Application Configuration

### Step 3: Generate Application Key
Laravel requires a unique application key for securing session data and encryption. You can generate this inside the `app` container.

```bash
docker-compose exec app php artisan key:generate
```

### Step 4: Run Database Migrations and Seeding
This command will set up the database schema and populate it with initial data.

1. **Terminal 1: Start the Vite frontend development server:**
   This compiles and serves your frontend assets (CSS, JS).
   ```bash
   npm run dev
   ```

2. **Terminal 2: Start the PHP backend server:**
   This runs the main Laravel application.
   ```bash
   php artisan serve
   ```

3. **Access the website:**
   Open your web browser and navigate to the URL provided by `php artisan serve` (usually `http://127.0.0.1:8000`).



## Deploy (production) with Docker

Use the provided production compose file `docker-compose.prod.yml` to build images and run services (app, nginx, mysql). Do NOT commit production secrets — create a file named `.env.prod` on the server with production values (example keys below). Ensure `APP_KEY` and database credentials are set there.

Example `.env.prod` (DO NOT commit this file):

```
APP_ENV=production
APP_DEBUG=false
APP_KEY=base64:your_generated_app_key_here
DB_CONNECTION=mysql
DB_HOST=db
DB_PORT=3306
DB_DATABASE=christconnect
DB_USERNAME=christconnect
DB_PASSWORD=verysecurepassword
MYSQL_ROOT_PASSWORD=verysecurepassword
```

Deploy steps (on the server):

```bash
# Build and start services
docker-compose -f docker-compose.prod.yml build --pull --no-cache
docker-compose -f docker-compose.prod.yml up -d

# Run migrations (one-time)
docker-compose -f docker-compose.prod.yml exec app php artisan migrate --force

# Seed donations or other non-sensitive seeders
docker-compose -f docker-compose.prod.yml exec app php artisan db:seed --class=DonationSeeder --force
```

Notes:
- The production compose mounts the project directory into containers to keep things simple for deployment; ensure the repo on the server is up-to-date and contains built assets. If you prefer fully immutable images (no bind mounts), let me know and I will change the compose to bake files into the image.
- If using this compose on a public server, ensure the server's firewall allows only the necessary ports (80/443) and secure the DB.

## Git Tips: Rollback Sebelum / Setelah `git pull`

- Cek riwayat commit:
  ```bash
  git log --oneline
  ```
- Kembali ke commit tertentu (rollback lokal):
  ```bash
  git reset --hard <commit_hash>
  ```
- Paksa remote ikut mundur (gunakan hati‑hati):
  ```bash
  git push --force origin main
  ```
- Alternatif aman (tanpa rewrite riwayat): batalkan commit tertentu dengan commit baru:
  ```bash
  git revert <commit_hash>
  git push origin main
  ```